from builtins import filter
from builtins import range
from __future__ import annotations

from codecs import BOM_UTF8, BOM_UTF16_BE, BOM_UTF16_LE, BOM_UTF32_BE, BOM_UTF32_LE
from encodings.aliases import aliases
from re import IGNORECASE
from re import compile as re_compile

# Contain for each eligible encoding a list of/item bytes SIG/BOM
ENCODING_MARKS: dict[str, bytes | list[bytes]] = {
    "utf_8": BOM_UTF8,
    "utf_7": [
        b"\x2b\x2f\x76\x38",
        b"\x2b\x2f\x76\x39",
        b"\x2b\x2f\x76\x2b",
        b"\x2b\x2f\x76\x2f",
        b"\x2b\x2f\x76\x38\x2d",
    ],
    "gb18030": b"\x84\x31\x95\x33",
    "utf_32": [BOM_UTF32_BE, BOM_UTF32_LE],
    "utf_16": [BOM_UTF16_BE, BOM_UTF16_LE],
}

TOO_SMALL_SEQUENCE: int = 32
TOO_BIG_SEQUENCE: int = int(10e6)

UTF8_MAXIMAL_ALLOCATION: int = 1_112_064

# Up-to-date Unicode ucd/15.0.0
UNICODE_RANGES_COMBINED: dict[str, range] = {
    "Control character": list(range(32)),
    "Basic Latin": list(range(32, 128)),
    "Latin-1 Supplement": list(range(128, 256)),
    "Latin Extended-A": list(range(256, 384)),
    "Latin Extended-B": list(range(384, 592)),
    "IPA Extensions": list(range(592, 688)),
    "Spacing Modifier Letters": list(range(688, 768)),
    "Combining Diacritical Marks": list(range(768, 880)),
    "Greek and Coptic": list(range(880, 1024)),
    "Cyrillic": list(range(1024, 1280)),
    "Cyrillic Supplement": list(range(1280, 1328)),
    "Armenian": list(range(1328, 1424)),
    "Hebrew": list(range(1424, 1536)),
    "Arabic": list(range(1536, 1792)),
    "Syriac": list(range(1792, 1872)),
    "Arabic Supplement": list(range(1872, 1920)),
    "Thaana": list(range(1920, 1984)),
    "NKo": list(range(1984, 2048)),
    "Samaritan": list(range(2048, 2112)),
    "Mandaic": list(range(2112, 2144)),
    "Syriac Supplement": list(range(2144, 2160)),
    "Arabic Extended-B": list(range(2160, 2208)),
    "Arabic Extended-A": list(range(2208, 2304)),
    "Devanagari": list(range(2304, 2432)),
    "Bengali": list(range(2432, 2560)),
    "Gurmukhi": list(range(2560, 2688)),
    "Gujarati": list(range(2688, 2816)),
    "Oriya": list(range(2816, 2944)),
    "Tamil": list(range(2944, 3072)),
    "Telugu": list(range(3072, 3200)),
    "Kannada": list(range(3200, 3328)),
    "Malayalam": list(range(3328, 3456)),
    "Sinhala": list(range(3456, 3584)),
    "Thai": list(range(3584, 3712)),
    "Lao": list(range(3712, 3840)),
    "Tibetan": list(range(3840, 4096)),
    "Myanmar": list(range(4096, 4256)),
    "Georgian": list(range(4256, 4352)),
    "Hangul Jamo": list(range(4352, 4608)),
    "Ethiopic": list(range(4608, 4992)),
    "Ethiopic Supplement": list(range(4992, 5024)),
    "Cherokee": list(range(5024, 5120)),
    "Unified Canadian Aboriginal Syllabics": list(range(5120, 5760)),
    "Ogham": list(range(5760, 5792)),
    "Runic": list(range(5792, 5888)),
    "Tagalog": list(range(5888, 5920)),
    "Hanunoo": list(range(5920, 5952)),
    "Buhid": list(range(5952, 5984)),
    "Tagbanwa": list(range(5984, 6016)),
    "Khmer": list(range(6016, 6144)),
    "Mongolian": list(range(6144, 6320)),
    "Unified Canadian Aboriginal Syllabics Extended": list(range(6320, 6400)),
    "Limbu": list(range(6400, 6480)),
    "Tai Le": list(range(6480, 6528)),
    "New Tai Lue": list(range(6528, 6624)),
    "Khmer Symbols": list(range(6624, 6656)),
    "Buginese": list(range(6656, 6688)),
    "Tai Tham": list(range(6688, 6832)),
    "Combining Diacritical Marks Extended": list(range(6832, 6912)),
    "Balinese": list(range(6912, 7040)),
    "Sundanese": list(range(7040, 7104)),
    "Batak": list(range(7104, 7168)),
    "Lepcha": list(range(7168, 7248)),
    "Ol Chiki": list(range(7248, 7296)),
    "Cyrillic Extended-C": list(range(7296, 7312)),
    "Georgian Extended": list(range(7312, 7360)),
    "Sundanese Supplement": list(range(7360, 7376)),
    "Vedic Extensions": list(range(7376, 7424)),
    "Phonetic Extensions": list(range(7424, 7552)),
    "Phonetic Extensions Supplement": list(range(7552, 7616)),
    "Combining Diacritical Marks Supplement": list(range(7616, 7680)),
    "Latin Extended Additional": list(range(7680, 7936)),
    "Greek Extended": list(range(7936, 8192)),
    "General Punctuation": list(range(8192, 8304)),
    "Superscripts and Subscripts": list(range(8304, 8352)),
    "Currency Symbols": list(range(8352, 8400)),
    "Combining Diacritical Marks for Symbols": list(range(8400, 8448)),
    "Letterlike Symbols": list(range(8448, 8528)),
    "Number Forms": list(range(8528, 8592)),
    "Arrows": list(range(8592, 8704)),
    "Mathematical Operators": list(range(8704, 8960)),
    "Miscellaneous Technical": list(range(8960, 9216)),
    "Control Pictures": list(range(9216, 9280)),
    "Optical Character Recognition": list(range(9280, 9312)),
    "Enclosed Alphanumerics": list(range(9312, 9472)),
    "Box Drawing": list(range(9472, 9600)),
    "Block Elements": list(range(9600, 9632)),
    "Geometric Shapes": list(range(9632, 9728)),
    "Miscellaneous Symbols": list(range(9728, 9984)),
    "Dingbats": list(range(9984, 10176)),
    "Miscellaneous Mathematical Symbols-A": list(range(10176, 10224)),
    "Supplemental Arrows-A": list(range(10224, 10240)),
    "Braille Patterns": list(range(10240, 10496)),
    "Supplemental Arrows-B": list(range(10496, 10624)),
    "Miscellaneous Mathematical Symbols-B": list(range(10624, 10752)),
    "Supplemental Mathematical Operators": list(range(10752, 11008)),
    "Miscellaneous Symbols and Arrows": list(range(11008, 11264)),
    "Glagolitic": list(range(11264, 11360)),
    "Latin Extended-C": list(range(11360, 11392)),
    "Coptic": list(range(11392, 11520)),
    "Georgian Supplement": list(range(11520, 11568)),
    "Tifinagh": list(range(11568, 11648)),
    "Ethiopic Extended": list(range(11648, 11744)),
    "Cyrillic Extended-A": list(range(11744, 11776)),
    "Supplemental Punctuation": list(range(11776, 11904)),
    "CJK Radicals Supplement": list(range(11904, 12032)),
    "Kangxi Radicals": list(range(12032, 12256)),
    "Ideographic Description Characters": list(range(12272, 12288)),
    "CJK Symbols and Punctuation": list(range(12288, 12352)),
    "Hiragana": list(range(12352, 12448)),
    "Katakana": list(range(12448, 12544)),
    "Bopomofo": list(range(12544, 12592)),
    "Hangul Compatibility Jamo": list(range(12592, 12688)),
    "Kanbun": list(range(12688, 12704)),
    "Bopomofo Extended": list(range(12704, 12736)),
    "CJK Strokes": list(range(12736, 12784)),
    "Katakana Phonetic Extensions": list(range(12784, 12800)),
    "Enclosed CJK Letters and Months": list(range(12800, 13056)),
    "CJK Compatibility": list(range(13056, 13312)),
    "CJK Unified Ideographs Extension A": list(range(13312, 19904)),
    "Yijing Hexagram Symbols": list(range(19904, 19968)),
    "CJK Unified Ideographs": list(range(19968, 40960)),
    "Yi Syllables": list(range(40960, 42128)),
    "Yi Radicals": list(range(42128, 42192)),
    "Lisu": list(range(42192, 42240)),
    "Vai": list(range(42240, 42560)),
    "Cyrillic Extended-B": list(range(42560, 42656)),
    "Bamum": list(range(42656, 42752)),
    "Modifier Tone Letters": list(range(42752, 42784)),
    "Latin Extended-D": list(range(42784, 43008)),
    "Syloti Nagri": list(range(43008, 43056)),
    "Common Indic Number Forms": list(range(43056, 43072)),
    "Phags-pa": list(range(43072, 43136)),
    "Saurashtra": list(range(43136, 43232)),
    "Devanagari Extended": list(range(43232, 43264)),
    "Kayah Li": list(range(43264, 43312)),
    "Rejang": list(range(43312, 43360)),
    "Hangul Jamo Extended-A": list(range(43360, 43392)),
    "Javanese": list(range(43392, 43488)),
    "Myanmar Extended-B": list(range(43488, 43520)),
    "Cham": list(range(43520, 43616)),
    "Myanmar Extended-A": list(range(43616, 43648)),
    "Tai Viet": list(range(43648, 43744)),
    "Meetei Mayek Extensions": list(range(43744, 43776)),
    "Ethiopic Extended-A": list(range(43776, 43824)),
    "Latin Extended-E": list(range(43824, 43888)),
    "Cherokee Supplement": list(range(43888, 43968)),
    "Meetei Mayek": list(range(43968, 44032)),
    "Hangul Syllables": list(range(44032, 55216)),
    "Hangul Jamo Extended-B": list(range(55216, 55296)),
    "High Surrogates": list(range(55296, 56192)),
    "High Private Use Surrogates": list(range(56192, 56320)),
    "Low Surrogates": list(range(56320, 57344)),
    "Private Use Area": list(range(57344, 63744)),
    "CJK Compatibility Ideographs": list(range(63744, 64256)),
    "Alphabetic Presentation Forms": list(range(64256, 64336)),
    "Arabic Presentation Forms-A": list(range(64336, 65024)),
    "Variation Selectors": list(range(65024, 65040)),
    "Vertical Forms": list(range(65040, 65056)),
    "Combining Half Marks": list(range(65056, 65072)),
    "CJK Compatibility Forms": list(range(65072, 65104)),
    "Small Form Variants": list(range(65104, 65136)),
    "Arabic Presentation Forms-B": list(range(65136, 65280)),
    "Halfwidth and Fullwidth Forms": list(range(65280, 65520)),
    "Specials": list(range(65520, 65536)),
    "Linear B Syllabary": list(range(65536, 65664)),
    "Linear B Ideograms": list(range(65664, 65792)),
    "Aegean Numbers": list(range(65792, 65856)),
    "Ancient Greek Numbers": list(range(65856, 65936)),
    "Ancient Symbols": list(range(65936, 66000)),
    "Phaistos Disc": list(range(66000, 66048)),
    "Lycian": list(range(66176, 66208)),
    "Carian": list(range(66208, 66272)),
    "Coptic Epact Numbers": list(range(66272, 66304)),
    "Old Italic": list(range(66304, 66352)),
    "Gothic": list(range(66352, 66384)),
    "Old Permic": list(range(66384, 66432)),
    "Ugaritic": list(range(66432, 66464)),
    "Old Persian": list(range(66464, 66528)),
    "Deseret": list(range(66560, 66640)),
    "Shavian": list(range(66640, 66688)),
    "Osmanya": list(range(66688, 66736)),
    "Osage": list(range(66736, 66816)),
    "Elbasan": list(range(66816, 66864)),
    "Caucasian Albanian": list(range(66864, 66928)),
    "Vithkuqi": list(range(66928, 67008)),
    "Linear A": list(range(67072, 67456)),
    "Latin Extended-F": list(range(67456, 67520)),
    "Cypriot Syllabary": list(range(67584, 67648)),
    "Imperial Aramaic": list(range(67648, 67680)),
    "Palmyrene": list(range(67680, 67712)),
    "Nabataean": list(range(67712, 67760)),
    "Hatran": list(range(67808, 67840)),
    "Phoenician": list(range(67840, 67872)),
    "Lydian": list(range(67872, 67904)),
    "Meroitic Hieroglyphs": list(range(67968, 68000)),
    "Meroitic Cursive": list(range(68000, 68096)),
    "Kharoshthi": list(range(68096, 68192)),
    "Old South Arabian": list(range(68192, 68224)),
    "Old North Arabian": list(range(68224, 68256)),
    "Manichaean": list(range(68288, 68352)),
    "Avestan": list(range(68352, 68416)),
    "Inscriptional Parthian": list(range(68416, 68448)),
    "Inscriptional Pahlavi": list(range(68448, 68480)),
    "Psalter Pahlavi": list(range(68480, 68528)),
    "Old Turkic": list(range(68608, 68688)),
    "Old Hungarian": list(range(68736, 68864)),
    "Hanifi Rohingya": list(range(68864, 68928)),
    "Rumi Numeral Symbols": list(range(69216, 69248)),
    "Yezidi": list(range(69248, 69312)),
    "Arabic Extended-C": list(range(69312, 69376)),
    "Old Sogdian": list(range(69376, 69424)),
    "Sogdian": list(range(69424, 69488)),
    "Old Uyghur": list(range(69488, 69552)),
    "Chorasmian": list(range(69552, 69600)),
    "Elymaic": list(range(69600, 69632)),
    "Brahmi": list(range(69632, 69760)),
    "Kaithi": list(range(69760, 69840)),
    "Sora Sompeng": list(range(69840, 69888)),
    "Chakma": list(range(69888, 69968)),
    "Mahajani": list(range(69968, 70016)),
    "Sharada": list(range(70016, 70112)),
    "Sinhala Archaic Numbers": list(range(70112, 70144)),
    "Khojki": list(range(70144, 70224)),
    "Multani": list(range(70272, 70320)),
    "Khudawadi": list(range(70320, 70400)),
    "Grantha": list(range(70400, 70528)),
    "Newa": list(range(70656, 70784)),
    "Tirhuta": list(range(70784, 70880)),
    "Siddham": list(range(71040, 71168)),
    "Modi": list(range(71168, 71264)),
    "Mongolian Supplement": list(range(71264, 71296)),
    "Takri": list(range(71296, 71376)),
    "Ahom": list(range(71424, 71504)),
    "Dogra": list(range(71680, 71760)),
    "Warang Citi": list(range(71840, 71936)),
    "Dives Akuru": list(range(71936, 72032)),
    "Nandinagari": list(range(72096, 72192)),
    "Zanabazar Square": list(range(72192, 72272)),
    "Soyombo": list(range(72272, 72368)),
    "Unified Canadian Aboriginal Syllabics Extended-A": list(range(72368, 72384)),
    "Pau Cin Hau": list(range(72384, 72448)),
    "Devanagari Extended-A": list(range(72448, 72544)),
    "Bhaiksuki": list(range(72704, 72816)),
    "Marchen": list(range(72816, 72896)),
    "Masaram Gondi": list(range(72960, 73056)),
    "Gunjala Gondi": list(range(73056, 73136)),
    "Makasar": list(range(73440, 73472)),
    "Kawi": list(range(73472, 73568)),
    "Lisu Supplement": list(range(73648, 73664)),
    "Tamil Supplement": list(range(73664, 73728)),
    "Cuneiform": list(range(73728, 74752)),
    "Cuneiform Numbers and Punctuation": list(range(74752, 74880)),
    "Early Dynastic Cuneiform": list(range(74880, 75088)),
    "Cypro-Minoan": list(range(77712, 77824)),
    "Egyptian Hieroglyphs": list(range(77824, 78896)),
    "Egyptian Hieroglyph Format Controls": list(range(78896, 78944)),
    "Anatolian Hieroglyphs": list(range(82944, 83584)),
    "Bamum Supplement": list(range(92160, 92736)),
    "Mro": list(range(92736, 92784)),
    "Tangsa": list(range(92784, 92880)),
    "Bassa Vah": list(range(92880, 92928)),
    "Pahawh Hmong": list(range(92928, 93072)),
    "Medefaidrin": list(range(93760, 93856)),
    "Miao": list(range(93952, 94112)),
    "Ideographic Symbols and Punctuation": list(range(94176, 94208)),
    "Tangut": list(range(94208, 100352)),
    "Tangut Components": list(range(100352, 101120)),
    "Khitan Small Script": list(range(101120, 101632)),
    "Tangut Supplement": list(range(101632, 101760)),
    "Kana Extended-B": list(range(110576, 110592)),
    "Kana Supplement": list(range(110592, 110848)),
    "Kana Extended-A": list(range(110848, 110896)),
    "Small Kana Extension": list(range(110896, 110960)),
    "Nushu": list(range(110960, 111360)),
    "Duployan": list(range(113664, 113824)),
    "Shorthand Format Controls": list(range(113824, 113840)),
    "Znamenny Musical Notation": list(range(118528, 118736)),
    "Byzantine Musical Symbols": list(range(118784, 119040)),
    "Musical Symbols": list(range(119040, 119296)),
    "Ancient Greek Musical Notation": list(range(119296, 119376)),
    "Kaktovik Numerals": list(range(119488, 119520)),
    "Mayan Numerals": list(range(119520, 119552)),
    "Tai Xuan Jing Symbols": list(range(119552, 119648)),
    "Counting Rod Numerals": list(range(119648, 119680)),
    "Mathematical Alphanumeric Symbols": list(range(119808, 120832)),
    "Sutton SignWriting": list(range(120832, 121520)),
    "Latin Extended-G": list(range(122624, 122880)),
    "Glagolitic Supplement": list(range(122880, 122928)),
    "Cyrillic Extended-D": list(range(122928, 123024)),
    "Nyiakeng Puachue Hmong": list(range(123136, 123216)),
    "Toto": list(range(123536, 123584)),
    "Wancho": list(range(123584, 123648)),
    "Nag Mundari": list(range(124112, 124160)),
    "Ethiopic Extended-B": list(range(124896, 124928)),
    "Mende Kikakui": list(range(124928, 125152)),
    "Adlam": list(range(125184, 125280)),
    "Indic Siyaq Numbers": list(range(126064, 126144)),
    "Ottoman Siyaq Numbers": list(range(126208, 126288)),
    "Arabic Mathematical Alphabetic Symbols": list(range(126464, 126720)),
    "Mahjong Tiles": list(range(126976, 127024)),
    "Domino Tiles": list(range(127024, 127136)),
    "Playing Cards": list(range(127136, 127232)),
    "Enclosed Alphanumeric Supplement": list(range(127232, 127488)),
    "Enclosed Ideographic Supplement": list(range(127488, 127744)),
    "Miscellaneous Symbols and Pictographs": list(range(127744, 128512)),
    "Emoticons range(Emoji)": list(range(128512, 128592)),
    "Ornamental Dingbats": list(range(128592, 128640)),
    "Transport and Map Symbols": list(range(128640, 128768)),
    "Alchemical Symbols": list(range(128768, 128896)),
    "Geometric Shapes Extended": list(range(128896, 129024)),
    "Supplemental Arrows-C": list(range(129024, 129280)),
    "Supplemental Symbols and Pictographs": list(range(129280, 129536)),
    "Chess Symbols": list(range(129536, 129648)),
    "Symbols and Pictographs Extended-A": list(range(129648, 129792)),
    "Symbols for Legacy Computing": list(range(129792, 130048)),
    "CJK Unified Ideographs Extension B": list(range(131072, 173792)),
    "CJK Unified Ideographs Extension C": list(range(173824, 177984)),
    "CJK Unified Ideographs Extension D": list(range(177984, 178208)),
    "CJK Unified Ideographs Extension E": list(range(178208, 183984)),
    "CJK Unified Ideographs Extension F": list(range(183984, 191472)),
    "CJK Compatibility Ideographs Supplement": list(range(194560, 195104)),
    "CJK Unified Ideographs Extension G": list(range(196608, 201552)),
    "CJK Unified Ideographs Extension H": list(range(201552, 205744)),
    "Tags": list(range(917504, 917632)),
    "Variation Selectors Supplement": list(range(917760, 918000)),
    "Supplementary Private Use Area-A": list(range(983040, 1048576)),
    "Supplementary Private Use Area-B": list(range(1048576, 1114112)),
}


UNICODE_SECONDARY_RANGE_KEYWORD: list[str] = [
    "Supplement",
    "Extended",
    "Extensions",
    "Modifier",
    "Marks",
    "Punctuation",
    "Symbols",
    "Forms",
    "Operators",
    "Miscellaneous",
    "Drawing",
    "Block",
    "Shapes",
    "Supplemental",
    "Tags",
]

RE_POSSIBLE_ENCODING_INDICATION = re_compile(
    r"(?:(?:encoding)|(?:charset)|(?:coding))(?:[\:= ]{1,10})(?:[\"\']?)([a-zA-Z0-9\-_]+)(?:[\"\']?)",
    IGNORECASE,
)

IANA_NO_ALIASES = [
    "cp720",
    "cp737",
    "cp856",
    "cp874",
    "cp875",
    "cp1006",
    "koi8_r",
    "koi8_t",
    "koi8_u",
]

IANA_SUPPORTED: list[str] = sorted(
    filter(
        lambda x: x.endswith("_codec") is False
        and x not in {"rot_13", "tactis", "mbcs"},
        list(set(aliases.values())) + IANA_NO_ALIASES,
    )
)

IANA_SUPPORTED_COUNT: int = len(IANA_SUPPORTED)

# pre-computed code page that are similar using the function cp_similarity.
IANA_SUPPORTED_SIMILAR: dict[str, list[str]] = {
    "cp037": ["cp1026", "cp1140", "cp273", "cp500"],
    "cp1026": ["cp037", "cp1140", "cp273", "cp500"],
    "cp1125": ["cp866"],
    "cp1140": ["cp037", "cp1026", "cp273", "cp500"],
    "cp1250": ["iso8859_2"],
    "cp1251": ["kz1048", "ptcp154"],
    "cp1252": ["iso8859_15", "iso8859_9", "latin_1"],
    "cp1253": ["iso8859_7"],
    "cp1254": ["iso8859_15", "iso8859_9", "latin_1"],
    "cp1257": ["iso8859_13"],
    "cp273": ["cp037", "cp1026", "cp1140", "cp500"],
    "cp437": ["cp850", "cp858", "cp860", "cp861", "cp862", "cp863", "cp865"],
    "cp500": ["cp037", "cp1026", "cp1140", "cp273"],
    "cp850": ["cp437", "cp857", "cp858", "cp865"],
    "cp857": ["cp850", "cp858", "cp865"],
    "cp858": ["cp437", "cp850", "cp857", "cp865"],
    "cp860": ["cp437", "cp861", "cp862", "cp863", "cp865"],
    "cp861": ["cp437", "cp860", "cp862", "cp863", "cp865"],
    "cp862": ["cp437", "cp860", "cp861", "cp863", "cp865"],
    "cp863": ["cp437", "cp860", "cp861", "cp862", "cp865"],
    "cp865": ["cp437", "cp850", "cp857", "cp858", "cp860", "cp861", "cp862", "cp863"],
    "cp866": ["cp1125"],
    "iso8859_10": ["iso8859_14", "iso8859_15", "iso8859_4", "iso8859_9", "latin_1"],
    "iso8859_11": ["tis_620"],
    "iso8859_13": ["cp1257"],
    "iso8859_14": [
        "iso8859_10",
        "iso8859_15",
        "iso8859_16",
        "iso8859_3",
        "iso8859_9",
        "latin_1",
    ],
    "iso8859_15": [
        "cp1252",
        "cp1254",
        "iso8859_10",
        "iso8859_14",
        "iso8859_16",
        "iso8859_3",
        "iso8859_9",
        "latin_1",
    ],
    "iso8859_16": [
        "iso8859_14",
        "iso8859_15",
        "iso8859_2",
        "iso8859_3",
        "iso8859_9",
        "latin_1",
    ],
    "iso8859_2": ["cp1250", "iso8859_16", "iso8859_4"],
    "iso8859_3": ["iso8859_14", "iso8859_15", "iso8859_16", "iso8859_9", "latin_1"],
    "iso8859_4": ["iso8859_10", "iso8859_2", "iso8859_9", "latin_1"],
    "iso8859_7": ["cp1253"],
    "iso8859_9": [
        "cp1252",
        "cp1254",
        "cp1258",
        "iso8859_10",
        "iso8859_14",
        "iso8859_15",
        "iso8859_16",
        "iso8859_3",
        "iso8859_4",
        "latin_1",
    ],
    "kz1048": ["cp1251", "ptcp154"],
    "latin_1": [
        "cp1252",
        "cp1254",
        "cp1258",
        "iso8859_10",
        "iso8859_14",
        "iso8859_15",
        "iso8859_16",
        "iso8859_3",
        "iso8859_4",
        "iso8859_9",
    ],
    "mac_iceland": ["mac_roman", "mac_turkish"],
    "mac_roman": ["mac_iceland", "mac_turkish"],
    "mac_turkish": ["mac_iceland", "mac_roman"],
    "ptcp154": ["cp1251", "kz1048"],
    "tis_620": ["iso8859_11"],
}


CHARDET_CORRESPONDENCE: dict[str, str] = {
    "iso2022_kr": "ISO-2022-KR",
    "iso2022_jp": "ISO-2022-JP",
    "euc_kr": "EUC-KR",
    "tis_620": "TIS-620",
    "utf_32": "UTF-32",
    "euc_jp": "EUC-JP",
    "koi8_r": "KOI8-R",
    "iso8859_1": "ISO-8859-1",
    "iso8859_2": "ISO-8859-2",
    "iso8859_5": "ISO-8859-5",
    "iso8859_6": "ISO-8859-6",
    "iso8859_7": "ISO-8859-7",
    "iso8859_8": "ISO-8859-8",
    "utf_16": "UTF-16",
    "cp855": "IBM855",
    "mac_cyrillic": "MacCyrillic",
    "gb2312": "GB2312",
    "gb18030": "GB18030",
    "cp932": "CP932",
    "cp866": "IBM866",
    "utf_8": "utf-8",
    "utf_8_sig": "UTF-8-SIG",
    "shift_jis": "SHIFT_JIS",
    "big5": "Big5",
    "cp1250": "windows-1250",
    "cp1251": "windows-1251",
    "cp1252": "Windows-1252",
    "cp1253": "windows-1253",
    "cp1255": "windows-1255",
    "cp1256": "windows-1256",
    "cp1254": "Windows-1254",
    "cp949": "CP949",
}


COMMON_SAFE_ASCII_CHARACTERS: set[str] = {
    "<",
    ">",
    "=",
    ":",
    "/",
    "&",
    ";",
    "{",
    "}",
    "[",
    "]",
    ",",
    "|",
    '"',
    "-",
    "(",
    ")",
}


KO_NAMES: set[str] = {"johab", "cp949", "euc_kr"}
ZH_NAMES: set[str] = {"big5", "cp950", "big5hkscs", "hz"}

# Logging LEVEL below DEBUG
TRACE: int = 5


# Language label that contain the em dash "—"
# character are to be considered alternative seq to origin
FREQUENCIES: dict[str, list[str]] = {
    "English": [
        "e",
        "a",
        "t",
        "i",
        "o",
        "n",
        "s",
        "r",
        "h",
        "l",
        "d",
        "c",
        "u",
        "m",
        "f",
        "p",
        "g",
        "w",
        "y",
        "b",
        "v",
        "k",
        "x",
        "j",
        "z",
        "q",
    ],
    "English—": [
        "e",
        "a",
        "t",
        "i",
        "o",
        "n",
        "s",
        "r",
        "h",
        "l",
        "d",
        "c",
        "m",
        "u",
        "f",
        "p",
        "g",
        "w",
        "b",
        "y",
        "v",
        "k",
        "j",
        "x",
        "z",
        "q",
    ],
    "German": [
        "e",
        "n",
        "i",
        "r",
        "s",
        "t",
        "a",
        "d",
        "h",
        "u",
        "l",
        "g",
        "o",
        "c",
        "m",
        "b",
        "f",
        "k",
        "w",
        "z",
        "p",
        "v",
        "ü",
        "ä",
        "ö",
        "j",
    ],
    "French": [
        "e",
        "a",
        "s",
        "n",
        "i",
        "t",
        "r",
        "l",
        "u",
        "o",
        "d",
        "c",
        "p",
        "m",
        "é",
        "v",
        "g",
        "f",
        "b",
        "h",
        "q",
        "à",
        "x",
        "è",
        "y",
        "j",
    ],
    "Dutch": [
        "e",
        "n",
        "a",
        "i",
        "r",
        "t",
        "o",
        "d",
        "s",
        "l",
        "g",
        "h",
        "v",
        "m",
        "u",
        "k",
        "c",
        "p",
        "b",
        "w",
        "j",
        "z",
        "f",
        "y",
        "x",
        "ë",
    ],
    "Italian": [
        "e",
        "i",
        "a",
        "o",
        "n",
        "l",
        "t",
        "r",
        "s",
        "c",
        "d",
        "u",
        "p",
        "m",
        "g",
        "v",
        "f",
        "b",
        "z",
        "h",
        "q",
        "è",
        "à",
        "k",
        "y",
        "ò",
    ],
    "Polish": [
        "a",
        "i",
        "o",
        "e",
        "n",
        "r",
        "z",
        "w",
        "s",
        "c",
        "t",
        "k",
        "y",
        "d",
        "p",
        "m",
        "u",
        "l",
        "j",
        "ł",
        "g",
        "b",
        "h",
        "ą",
        "ę",
        "ó",
    ],
    "Spanish": [
        "e",
        "a",
        "o",
        "n",
        "s",
        "r",
        "i",
        "l",
        "d",
        "t",
        "c",
        "u",
        "m",
        "p",
        "b",
        "g",
        "v",
        "f",
        "y",
        "ó",
        "h",
        "q",
        "í",
        "j",
        "z",
        "á",
    ],
    "Russian": [
        "о",
        "а",
        "е",
        "и",
        "н",
        "с",
        "т",
        "р",
        "в",
        "л",
        "к",
        "м",
        "д",
        "п",
        "у",
        "г",
        "я",
        "ы",
        "з",
        "б",
        "й",
        "ь",
        "ч",
        "х",
        "ж",
        "ц",
    ],
    # Jap-Kanji
    "Japanese": [
        "人",
        "一",
        "大",
        "亅",
        "丁",
        "丨",
        "竹",
        "笑",
        "口",
        "日",
        "今",
        "二",
        "彳",
        "行",
        "十",
        "土",
        "丶",
        "寸",
        "寺",
        "時",
        "乙",
        "丿",
        "乂",
        "气",
        "気",
        "冂",
        "巾",
        "亠",
        "市",
        "目",
        "儿",
        "見",
        "八",
        "小",
        "凵",
        "県",
        "月",
        "彐",
        "門",
        "間",
        "木",
        "東",
        "山",
        "出",
        "本",
        "中",
        "刀",
        "分",
        "耳",
        "又",
        "取",
        "最",
        "言",
        "田",
        "心",
        "思",
        "刂",
        "前",
        "京",
        "尹",
        "事",
        "生",
        "厶",
        "云",
        "会",
        "未",
        "来",
        "白",
        "冫",
        "楽",
        "灬",
        "馬",
        "尸",
        "尺",
        "駅",
        "明",
        "耂",
        "者",
        "了",
        "阝",
        "都",
        "高",
        "卜",
        "占",
        "厂",
        "广",
        "店",
        "子",
        "申",
        "奄",
        "亻",
        "俺",
        "上",
        "方",
        "冖",
        "学",
        "衣",
        "艮",
        "食",
        "自",
    ],
    # Jap-Katakana
    "Japanese—": [
        "ー",
        "ン",
        "ス",
        "・",
        "ル",
        "ト",
        "リ",
        "イ",
        "ア",
        "ラ",
        "ッ",
        "ク",
        "ド",
        "シ",
        "レ",
        "ジ",
        "タ",
        "フ",
        "ロ",
        "カ",
        "テ",
        "マ",
        "ィ",
        "グ",
        "バ",
        "ム",
        "プ",
        "オ",
        "コ",
        "デ",
        "ニ",
        "ウ",
        "メ",
        "サ",
        "ビ",
        "ナ",
        "ブ",
        "ャ",
        "エ",
        "ュ",
        "チ",
        "キ",
        "ズ",
        "ダ",
        "パ",
        "ミ",
        "ェ",
        "ョ",
        "ハ",
        "セ",
        "ベ",
        "ガ",
        "モ",
        "ツ",
        "ネ",
        "ボ",
        "ソ",
        "ノ",
        "ァ",
        "ヴ",
        "ワ",
        "ポ",
        "ペ",
        "ピ",
        "ケ",
        "ゴ",
        "ギ",
        "ザ",
        "ホ",
        "ゲ",
        "ォ",
        "ヤ",
        "ヒ",
        "ユ",
        "ヨ",
        "ヘ",
        "ゼ",
        "ヌ",
        "ゥ",
        "ゾ",
        "ヶ",
        "ヂ",
        "ヲ",
        "ヅ",
        "ヵ",
        "ヱ",
        "ヰ",
        "ヮ",
        "ヽ",
        "゠",
        "ヾ",
        "ヷ",
        "ヿ",
        "ヸ",
        "ヹ",
        "ヺ",
    ],
    # Jap-Hiragana
    "Japanese——": [
        "の",
        "に",
        "る",
        "た",
        "と",
        "は",
        "し",
        "い",
        "を",
        "で",
        "て",
        "が",
        "な",
        "れ",
        "か",
        "ら",
        "さ",
        "っ",
        "り",
        "す",
        "あ",
        "も",
        "こ",
        "ま",
        "う",
        "く",
        "よ",
        "き",
        "ん",
        "め",
        "お",
        "け",
        "そ",
        "つ",
        "だ",
        "や",
        "え",
        "ど",
        "わ",
        "ち",
        "み",
        "せ",
        "じ",
        "ば",
        "へ",
        "び",
        "ず",
        "ろ",
        "ほ",
        "げ",
        "む",
        "べ",
        "ひ",
        "ょ",
        "ゆ",
        "ぶ",
        "ご",
        "ゃ",
        "ね",
        "ふ",
        "ぐ",
        "ぎ",
        "ぼ",
        "ゅ",
        "づ",
        "ざ",
        "ぞ",
        "ぬ",
        "ぜ",
        "ぱ",
        "ぽ",
        "ぷ",
        "ぴ",
        "ぃ",
        "ぁ",
        "ぇ",
        "ぺ",
        "ゞ",
        "ぢ",
        "ぉ",
        "ぅ",
        "ゐ",
        "ゝ",
        "ゑ",
        "゛",
        "゜",
        "ゎ",
        "ゔ",
        "゚",
        "ゟ",
        "゙",
        "ゕ",
        "ゖ",
    ],
    "Portuguese": [
        "a",
        "e",
        "o",
        "s",
        "i",
        "r",
        "d",
        "n",
        "t",
        "m",
        "u",
        "c",
        "l",
        "p",
        "g",
        "v",
        "b",
        "f",
        "h",
        "ã",
        "q",
        "é",
        "ç",
        "á",
        "z",
        "í",
    ],
    "Swedish": [
        "e",
        "a",
        "n",
        "r",
        "t",
        "s",
        "i",
        "l",
        "d",
        "o",
        "m",
        "k",
        "g",
        "v",
        "h",
        "f",
        "u",
        "p",
        "ä",
        "c",
        "b",
        "ö",
        "å",
        "y",
        "j",
        "x",
    ],
    "Chinese": [
        "的",
        "一",
        "是",
        "不",
        "了",
        "在",
        "人",
        "有",
        "我",
        "他",
        "这",
        "个",
        "们",
        "中",
        "来",
        "上",
        "大",
        "为",
        "和",
        "国",
        "地",
        "到",
        "以",
        "说",
        "时",
        "要",
        "就",
        "出",
        "会",
        "可",
        "也",
        "你",
        "对",
        "生",
        "能",
        "而",
        "子",
        "那",
        "得",
        "于",
        "着",
        "下",
        "自",
        "之",
        "年",
        "过",
        "发",
        "后",
        "作",
        "里",
        "用",
        "道",
        "行",
        "所",
        "然",
        "家",
        "种",
        "事",
        "成",
        "方",
        "多",
        "经",
        "么",
        "去",
        "法",
        "学",
        "如",
        "都",
        "同",
        "现",
        "当",
        "没",
        "动",
        "面",
        "起",
        "看",
        "定",
        "天",
        "分",
        "还",
        "进",
        "好",
        "小",
        "部",
        "其",
        "些",
        "主",
        "样",
        "理",
        "心",
        "她",
        "本",
        "前",
        "开",
        "但",
        "因",
        "只",
        "从",
        "想",
        "实",
    ],
    "Ukrainian": [
        "о",
        "а",
        "н",
        "і",
        "и",
        "р",
        "в",
        "т",
        "е",
        "с",
        "к",
        "л",
        "у",
        "д",
        "м",
        "п",
        "з",
        "я",
        "ь",
        "б",
        "г",
        "й",
        "ч",
        "х",
        "ц",
        "ї",
    ],
    "Norwegian": [
        "e",
        "r",
        "n",
        "t",
        "a",
        "s",
        "i",
        "o",
        "l",
        "d",
        "g",
        "k",
        "m",
        "v",
        "f",
        "p",
        "u",
        "b",
        "h",
        "å",
        "y",
        "j",
        "ø",
        "c",
        "æ",
        "w",
    ],
    "Finnish": [
        "a",
        "i",
        "n",
        "t",
        "e",
        "s",
        "l",
        "o",
        "u",
        "k",
        "ä",
        "m",
        "r",
        "v",
        "j",
        "h",
        "p",
        "y",
        "d",
        "ö",
        "g",
        "c",
        "b",
        "f",
        "w",
        "z",
    ],
    "Vietnamese": [
        "n",
        "h",
        "t",
        "i",
        "c",
        "g",
        "a",
        "o",
        "u",
        "m",
        "l",
        "r",
        "à",
        "đ",
        "s",
        "e",
        "v",
        "p",
        "b",
        "y",
        "ư",
        "d",
        "á",
        "k",
        "ộ",
        "ế",
    ],
    "Czech": [
        "o",
        "e",
        "a",
        "n",
        "t",
        "s",
        "i",
        "l",
        "v",
        "r",
        "k",
        "d",
        "u",
        "m",
        "p",
        "í",
        "c",
        "h",
        "z",
        "á",
        "y",
        "j",
        "b",
        "ě",
        "é",
        "ř",
    ],
    "Hungarian": [
        "e",
        "a",
        "t",
        "l",
        "s",
        "n",
        "k",
        "r",
        "i",
        "o",
        "z",
        "á",
        "é",
        "g",
        "m",
        "b",
        "y",
        "v",
        "d",
        "h",
        "u",
        "p",
        "j",
        "ö",
        "f",
        "c",
    ],
    "Korean": [
        "이",
        "다",
        "에",
        "의",
        "는",
        "로",
        "하",
        "을",
        "가",
        "고",
        "지",
        "서",
        "한",
        "은",
        "기",
        "으",
        "년",
        "대",
        "사",
        "시",
        "를",
        "리",
        "도",
        "인",
        "스",
        "일",
    ],
    "Indonesian": [
        "a",
        "n",
        "e",
        "i",
        "r",
        "t",
        "u",
        "s",
        "d",
        "k",
        "m",
        "l",
        "g",
        "p",
        "b",
        "o",
        "h",
        "y",
        "j",
        "c",
        "w",
        "f",
        "v",
        "z",
        "x",
        "q",
    ],
    "Turkish": [
        "a",
        "e",
        "i",
        "n",
        "r",
        "l",
        "ı",
        "k",
        "d",
        "t",
        "s",
        "m",
        "y",
        "u",
        "o",
        "b",
        "ü",
        "ş",
        "v",
        "g",
        "z",
        "h",
        "c",
        "p",
        "ç",
        "ğ",
    ],
    "Romanian": [
        "e",
        "i",
        "a",
        "r",
        "n",
        "t",
        "u",
        "l",
        "o",
        "c",
        "s",
        "d",
        "p",
        "m",
        "ă",
        "f",
        "v",
        "î",
        "g",
        "b",
        "ș",
        "ț",
        "z",
        "h",
        "â",
        "j",
    ],
    "Farsi": [
        "ا",
        "ی",
        "ر",
        "د",
        "ن",
        "ه",
        "و",
        "م",
        "ت",
        "ب",
        "س",
        "ل",
        "ک",
        "ش",
        "ز",
        "ف",
        "گ",
        "ع",
        "خ",
        "ق",
        "ج",
        "آ",
        "پ",
        "ح",
        "ط",
        "ص",
    ],
    "Arabic": [
        "ا",
        "ل",
        "ي",
        "م",
        "و",
        "ن",
        "ر",
        "ت",
        "ب",
        "ة",
        "ع",
        "د",
        "س",
        "ف",
        "ه",
        "ك",
        "ق",
        "أ",
        "ح",
        "ج",
        "ش",
        "ط",
        "ص",
        "ى",
        "خ",
        "إ",
    ],
    "Danish": [
        "e",
        "r",
        "n",
        "t",
        "a",
        "i",
        "s",
        "d",
        "l",
        "o",
        "g",
        "m",
        "k",
        "f",
        "v",
        "u",
        "b",
        "h",
        "p",
        "å",
        "y",
        "ø",
        "æ",
        "c",
        "j",
        "w",
    ],
    "Serbian": [
        "а",
        "и",
        "о",
        "е",
        "н",
        "р",
        "с",
        "у",
        "т",
        "к",
        "ј",
        "в",
        "д",
        "м",
        "п",
        "л",
        "г",
        "з",
        "б",
        "a",
        "i",
        "e",
        "o",
        "n",
        "ц",
        "ш",
    ],
    "Lithuanian": [
        "i",
        "a",
        "s",
        "o",
        "r",
        "e",
        "t",
        "n",
        "u",
        "k",
        "m",
        "l",
        "p",
        "v",
        "d",
        "j",
        "g",
        "ė",
        "b",
        "y",
        "ų",
        "š",
        "ž",
        "c",
        "ą",
        "į",
    ],
    "Slovene": [
        "e",
        "a",
        "i",
        "o",
        "n",
        "r",
        "s",
        "l",
        "t",
        "j",
        "v",
        "k",
        "d",
        "p",
        "m",
        "u",
        "z",
        "b",
        "g",
        "h",
        "č",
        "c",
        "š",
        "ž",
        "f",
        "y",
    ],
    "Slovak": [
        "o",
        "a",
        "e",
        "n",
        "i",
        "r",
        "v",
        "t",
        "s",
        "l",
        "k",
        "d",
        "m",
        "p",
        "u",
        "c",
        "h",
        "j",
        "b",
        "z",
        "á",
        "y",
        "ý",
        "í",
        "č",
        "é",
    ],
    "Hebrew": [
        "י",
        "ו",
        "ה",
        "ל",
        "ר",
        "ב",
        "ת",
        "מ",
        "א",
        "ש",
        "נ",
        "ע",
        "ם",
        "ד",
        "ק",
        "ח",
        "פ",
        "ס",
        "כ",
        "ג",
        "ט",
        "צ",
        "ן",
        "ז",
        "ך",
    ],
    "Bulgarian": [
        "а",
        "и",
        "о",
        "е",
        "н",
        "т",
        "р",
        "с",
        "в",
        "л",
        "к",
        "д",
        "п",
        "м",
        "з",
        "г",
        "я",
        "ъ",
        "у",
        "б",
        "ч",
        "ц",
        "й",
        "ж",
        "щ",
        "х",
    ],
    "Croatian": [
        "a",
        "i",
        "o",
        "e",
        "n",
        "r",
        "j",
        "s",
        "t",
        "u",
        "k",
        "l",
        "v",
        "d",
        "m",
        "p",
        "g",
        "z",
        "b",
        "c",
        "č",
        "h",
        "š",
        "ž",
        "ć",
        "f",
    ],
    "Hindi": [
        "क",
        "र",
        "स",
        "न",
        "त",
        "म",
        "ह",
        "प",
        "य",
        "ल",
        "व",
        "ज",
        "द",
        "ग",
        "ब",
        "श",
        "ट",
        "अ",
        "ए",
        "थ",
        "भ",
        "ड",
        "च",
        "ध",
        "ष",
        "इ",
    ],
    "Estonian": [
        "a",
        "i",
        "e",
        "s",
        "t",
        "l",
        "u",
        "n",
        "o",
        "k",
        "r",
        "d",
        "m",
        "v",
        "g",
        "p",
        "j",
        "h",
        "ä",
        "b",
        "õ",
        "ü",
        "f",
        "c",
        "ö",
        "y",
    ],
    "Thai": [
        "า",
        "น",
        "ร",
        "อ",
        "ก",
        "เ",
        "ง",
        "ม",
        "ย",
        "ล",
        "ว",
        "ด",
        "ท",
        "ส",
        "ต",
        "ะ",
        "ป",
        "บ",
        "ค",
        "ห",
        "แ",
        "จ",
        "พ",
        "ช",
        "ข",
        "ใ",
    ],
    "Greek": [
        "α",
        "τ",
        "ο",
        "ι",
        "ε",
        "ν",
        "ρ",
        "σ",
        "κ",
        "η",
        "π",
        "ς",
        "υ",
        "μ",
        "λ",
        "ί",
        "ό",
        "ά",
        "γ",
        "έ",
        "δ",
        "ή",
        "ω",
        "χ",
        "θ",
        "ύ",
    ],
    "Tamil": [
        "க",
        "த",
        "ப",
        "ட",
        "ர",
        "ம",
        "ல",
        "ன",
        "வ",
        "ற",
        "ய",
        "ள",
        "ச",
        "ந",
        "இ",
        "ண",
        "அ",
        "ஆ",
        "ழ",
        "ங",
        "எ",
        "உ",
        "ஒ",
        "ஸ",
    ],
    "Kazakh": [
        "а",
        "ы",
        "е",
        "н",
        "т",
        "р",
        "л",
        "і",
        "д",
        "с",
        "м",
        "қ",
        "к",
        "о",
        "б",
        "и",
        "у",
        "ғ",
        "ж",
        "ң",
        "з",
        "ш",
        "й",
        "п",
        "г",
        "ө",
    ],
}

LANGUAGE_SUPPORTED_COUNT: int = len(FREQUENCIES)
